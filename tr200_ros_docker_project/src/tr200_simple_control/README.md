# TR200 Simple Control Package

TR200 λ΅λ΄‡μ λΌμ΄λ‹¤ μ„Όμ„λ¥Ό ν™μ©ν• μλ™ κµ¬λ™ λ° μ•μ „ μ μ–΄ μ‹μ¤ν…μ…λ‹λ‹¤. μ„Όμ„ λ°μ΄ν„°λ¥Ό κΈ°λ°μΌλ΅ μ¥μ• λ¬Ό κ°μ§€, μ•μ „ κ±°λ¦¬ μ μ§€, μλ™ μ •μ§€ λ“±μ κΈ°λ¥μ„ μ κ³µν•©λ‹λ‹¤.

## π“‹ κ°μ”

μ΄ ν¨ν‚¤μ§€λ” TR200 λ΅λ΄‡μ λ“€μ–Ό λΌμ΄λ‹¤ μ„Όμ„λ¥Ό ν™μ©ν•μ—¬ μλ™μΌλ΅ μ•λ’¤ κµ¬λ™ν•λ©΄μ„ μ¥μ• λ¬Όμ„ κ°μ§€ν•κ³  μ•μ „ κ±°λ¦¬μ— λ”°λΌ μ†λ„λ¥Ό μ΅°μ ν•κ±°λ‚ μ •μ§€ν•λ” μ‹μ¤ν…μ…λ‹λ‹¤. ROS ν™κ²½μ—μ„ μ‹¤ν–‰λλ©° μ‹¤μ‹κ°„ μ„Όμ„ λ°μ΄ν„° μ²λ¦¬μ™€ μ•μ „ μ μ–΄λ¥Ό μ κ³µν•©λ‹λ‹¤.

## π― ν•µμ‹¬ κΈ°λ¥

- **λ“€μ–Ό λΌμ΄λ‹¤ μ„Όμ„ ν™μ©**: TR200μ μ „λ°©/ν›„λ°© λΌμ΄λ‹¤ μ„Όμ„ λ°μ΄ν„° ν†µν•© μ²λ¦¬
- **μ‹¤μ‹κ°„ μ¥μ• λ¬Ό κ°μ§€**: 360λ„ μ „ν›„λ°© μ¥μ• λ¬Ό κ°μ§€ λ° κ±°λ¦¬ μΈ΅μ •
- **μ§€λ¥ν• μ†λ„ μ μ–΄**: κ±°λ¦¬μ— λ”°λ¥Έ μλ™ μ†λ„ μ΅°μ  (μ •μƒ β†’ κ°μ† β†’ μ •μ§€)
- **μ•μ „ μ°μ„  μ μ–΄**: μ„ν— μƒν™©μ—μ„ μ¦‰μ‹ λΉ„μƒ μ •μ§€
- **λ¶€λ“λ¬μ΄ μ μ–΄**: κΈ‰κ²©ν• κ°€μ†/κ°μ† λ°©μ§€
- **μλ™ λ°©ν–¥ μ „ν™**: μΌμ • μ‹κ°„λ§λ‹¤ μλ™μΌλ΅ λ°©ν–¥ μ „ν™
- **ROS ν†µν•©**: ROS ν† ν”½/μ„λΉ„μ¤λ¥Ό ν†µν• μ‹¤μ‹κ°„ λ¨λ‹ν„°λ§ λ° μ μ–΄

## π—οΈ μ‹μ¤ν… κµ¬μ΅°

### μ£Όμ” μ»΄ν¬λ„νΈ
- **μ„Όμ„ λ°μ΄ν„° μ²λ¦¬**: λ“€μ–Ό λΌμ΄λ‹¤ μ„Όμ„ λ°μ΄ν„° μμ‹  λ° λ¶„μ„
- **μ•μ „ μ μ–΄ λ΅μ§**: κ±°λ¦¬ κΈ°λ° μ†λ„ μ΅°μ  λ° λΉ„μƒ μ •μ§€
- **λ΅λ΄‡ μ μ–΄**: SDKλ¥Ό ν†µν• μ‹¤μ  λ΅λ΄‡ κµ¬λ™ μ μ–΄
- **ROS μΈν„°νμ΄μ¤**: ν† ν”½ λ°ν–‰ λ° μ„λΉ„μ¤ μ κ³µ

### ROS ν† ν”½
- `/scan`: μ›λ³Έ μ¤μΊλ„ λ°μ΄ν„° (sensor_msgs/LaserScan)
- `/processed_scan`: μ²λ¦¬λ μ„Όμ„ λ°μ΄ν„° (sensor_msgs/LaserScan)
- `/safe_cmd_vel`: μ•μ „ν• μ†λ„ λ…λ Ή (geometry_msgs/Twist)
- `/safety_status`: μ•μ „ μƒνƒ (std_msgs/String)
- `/obstacle_distance`: μ¥μ• λ¬Ό κ±°λ¦¬ (std_msgs/Float32)
- `/robot_status`: λ΅λ΄‡ μƒνƒ (std_msgs/String)
- `/emergency_stop`: λΉ„μƒ μ •μ§€ μƒνƒ (std_msgs/Bool)

### ROS μ„λΉ„μ¤
- `/set_safety_params`: μ•μ „ νλΌλ―Έν„° λ™μ  μ„¤μ •
- `/emergency_stop`: λΉ„μƒ μ •μ§€ μ„λΉ„μ¤

## π€ λΉ λ¥Έ μ‹μ‘

### 1. ν™κ²½ μ„¤μ •

Docker μ»¨ν…μ΄λ„μ—μ„ μ‘μ—…:
```bash
# μ»¨ν…μ΄λ„ μ‹¤ν–‰
./scripts/run_container.sh

# ROS λ§μ¤ν„° μ‹¤ν–‰
roscore

# μ¶”κ°€ ν„°λ―Έλ„ μ ‘μ†
./scripts/connect_container.sh
```

### 2. ν¨ν‚¤μ§€ λΉλ“

```bash
cd /catkin_ws
catkin_make
source devel/setup.bash
```

### 3. μ„Όμ„ κΈ°λ° μ•μ „ μ μ–΄ μ‹¤ν–‰

#### λ°©λ²• 1: ROS λ°μΉ νμΌλ΅ μ‹¤ν–‰ (κ¶μ¥)
```bash
# κΈ°λ³Έ μ„¤μ •μΌλ΅ μ‹¤ν–‰
roslaunch tr200_simple_control tr200_sensor_safety_controller.launch

# νλΌλ―Έν„° μ΅°μ •ν•μ—¬ μ‹¤ν–‰
roslaunch tr200_simple_control tr200_sensor_safety_controller.launch \
  min_obstacle_distance:=0.3 \
  warning_distance:=0.6 \
  normal_speed:=0.15
```

#### λ°©λ²• 2: μ§μ ‘ μ‹¤ν–‰
```bash
# ROS ν†µν•© μ μ–΄κΈ° μ‹¤ν–‰
rosrun tr200_simple_control sensor_based_safety_controller.py

# κΈ°λ³Έ μ™•λ³µ μ΄λ™ (μ°Έκ³ μ©)
rosrun tr200_simple_control simple_linear_motion.py
```

### 4. RViz μ‹κ°ν™”

```bash
# RVizλ΅ μ„Όμ„ λ°μ΄ν„° μ‹κ°ν™”
rviz -d src/tr200_simple_control/config/tr200_sensor_safety.rviz
```

## π“ ν¨ν‚¤μ§€ κµ¬μ΅°

```
tr200_simple_control/
β”β”€β”€ CMakeLists.txt                           # λΉλ“ μ„¤μ •
β”β”€β”€ package.xml                             # ν¨ν‚¤μ§€ λ§¤λ‹νμ¤νΈ
β”β”€β”€ README.md                               # ν¨ν‚¤μ§€ λ¬Έμ„
β”β”€β”€ launch/                                 # ROS λ°μΉ νμΌ
β”‚   β””β”€β”€ tr200_sensor_safety_controller.launch   # μ„Όμ„ μ•μ „ μ μ–΄ λ°μΉ
β”β”€β”€ config/                                 # μ„¤μ • νμΌ
β”‚   β”β”€β”€ tr200_sensor_safety_params.yaml        # ROS ν†µν•© μ•μ „ νλΌλ―Έν„°
β”‚   β”β”€β”€ tr200_sensor_safety.rviz              # RViz μ‹κ°ν™” μ„¤μ •
β”‚   β”β”€β”€ area_motion_params.yaml               # μμ—­ μ ν• κµ¬λ™ νλΌλ―Έν„°
β”‚   β”β”€β”€ robot_params.yaml                     # λ΅λ΄‡ κΈ°λ³Έ νλΌλ―Έν„°
β”‚   β””β”€β”€ test_safe_params.yaml                 # ν…μ¤νΈμ© μ•μ „ νλΌλ―Έν„°
β”β”€β”€ scripts/                                # Python μ μ–΄ μ¤ν¬λ¦½νΈ
β”‚   β”β”€β”€ sensor_based_safety_controller.py      # μμ SDK μ μ–΄κΈ°
β”‚   β””β”€β”€ simple_linear_motion.py                # κΈ°λ³Έ μ™•λ³µ μ΄λ™
β””β”€β”€ srv/                                    # ROS μ„λΉ„μ¤ μ •μ
    β””β”€β”€ SetSafetyParams.srv                    # μ•μ „ νλΌλ―Έν„° μ„¤μ • μ„λΉ„μ¤
```

## β™οΈ μ„¤μ •

### μ•μ „ μ μ–΄ νλΌλ―Έν„°

`config/tr200_sensor_safety_params.yaml`μ—μ„ μ•μ „ μ μ–΄ νλΌλ―Έν„°λ¥Ό μ„¤μ •ν•  μ μμµλ‹λ‹¤:

```yaml
# μ„Όμ„ μ„¤μ • (λ‹¨μ„: λ―Έν„°)
sensor:
  min_obstacle_distance: 0.5    # μµμ† μ¥μ• λ¬Ό κ±°λ¦¬ - μ„ν— κµ¬μ—­
  warning_distance: 0.8         # κ²½κ³  κ±°λ¦¬ - μ£Όμ κµ¬μ—­  
  safe_distance: 1.0           # μ•μ „ κ±°λ¦¬ - μ•μ „ κµ¬μ—­
  
  # μ„Όμ„ ν™μ„±ν™”
  front_sensor_enabled: true
  rear_sensor_enabled: true

# μ μ–΄ μ„¤μ • (λ‹¨μ„: m/s)
control:
  normal_speed: 0.2            # μ •μƒ μ†λ„
  slow_speed: 0.1              # κ°μ† μ†λ„
  stop_speed: 0.0              # μ •μ§€ μ†λ„
  control_frequency: 20.0      # μ μ–΄ μ£Όνμ (Hz)
```

### λ΅λ΄‡ μ—°κ²° μ„¤μ •

```yaml
# λ΅λ΄‡ μ—°κ²° μ •λ³΄
robot:
  ip: "169.254.128.2"  # TR200 λ΅λ΄‡ IP
  port: 5480           # TR200 λ΅λ΄‡ ν¬νΈ
  identity: "tr200_sensor_controller"
```

## π” μ„Όμ„ λ°μ΄ν„° μ²λ¦¬

### λ“€μ–Ό μ„Όμ„ λ¶„μ„

μ‹μ¤ν…μ€ TR200μ λ“€μ–Ό λΌμ΄λ‹¤ μ„Όμ„ λ°μ΄ν„°λ¥Ό λ‹¤μκ³Ό κ°™μ΄ μ²λ¦¬ν•©λ‹λ‹¤:

1. **μ„Όμ„ λ°μ΄ν„° λ¶„λ¦¬**: μ „λ°© μ„Όμ„(270Β°~810Β°)μ™€ ν›„λ°© μ„Όμ„(810Β°~270Β°)λ΅ λ¶„λ¦¬
2. **μ¥μ• λ¬Ό κ°μ§€**: κ° μ„Όμ„λ³„λ΅ μµμ† κ±°λ¦¬ λ° μ¥μ• λ¬Ό κ°μ κ³„μ‚°
3. **ν†µν•© λ¶„μ„**: μ „ν›„λ°© μ„Όμ„ λ°μ΄ν„°λ¥Ό ν†µν•©ν•μ—¬ μ „μ²΄ μ•μ „ μƒνƒ νλ‹¨

### μ•μ „ κµ¬μ—­ μ„¤μ •

- **μ•μ „ κµ¬μ—­** (1.0m μ΄μƒ): μ •μƒ μ†λ„λ΅ μ΄λ™
- **μ£Όμ κµ¬μ—­** (0.8m~1.0m): κ°μ†ν•μ—¬ μ΄λ™
- **μ„ν— κµ¬μ—­** (0.5m μ΄ν•): μ¦‰μ‹ μ •μ§€

## π“ λ¨λ‹ν„°λ§ λ° λ””λ²„κΉ…

### ROS ν† ν”½ λ¨λ‹ν„°λ§

```bash
# μ•μ „ μƒνƒ λ¨λ‹ν„°λ§
rostopic echo /safety_status

# μ¥μ• λ¬Ό κ±°λ¦¬ λ¨λ‹ν„°λ§
rostopic echo /obstacle_distance

# μ†λ„ λ…λ Ή λ¨λ‹ν„°λ§
rostopic echo /safe_cmd_vel

# μ¤μΊλ„ λ°μ΄ν„° λ¨λ‹ν„°λ§
rostopic echo /scan

# λ΅λ΄‡ μƒνƒ λ¨λ‹ν„°λ§
rostopic echo /robot_status
```

### ROS μ„λΉ„μ¤ μ‚¬μ©

```bash
# μ•μ „ νλΌλ―Έν„° λ™μ  λ³€κ²½
rosservice call /set_safety_params "min_obstacle_distance: 0.3
warning_distance: 0.6
safe_distance: 0.9
normal_speed: 0.15
slow_speed: 0.05"

# λΉ„μƒ μ •μ§€ μ„λΉ„μ¤
rosservice call /emergency_stop "data: true"
```

### μμƒ μ¶λ ¥

```
π“΅ μ¤μΊλ„ λ°μ΄ν„° μμ‹ : 1081κ° ν¬μΈνΈ
π“΅ κ°λ„ λ²”μ„: -3.14Β° ~ 3.14Β°
π“΅ κ±°λ¦¬ λ²”μ„: 0.01m ~ 50.00m
============================================================
π” μ„Όμ„ λ¶„λ¦¬ μ™„λ£:
   μ „λ°© μ„Όμ„: 540κ° ν¬μΈνΈ (μΈλ±μ¤ 270~810)
   ν›„λ°© μ„Όμ„: 540κ° ν¬μΈνΈ (μΈλ±μ¤ 810~270)
π” λ“€μ–Ό μ„Όμ„ λ¶„μ„:
   μ „λ°© μ„Όμ„: μµμ†κ±°λ¦¬ 1.200m, μ¥μ• λ¬Ό 2κ°
   ν›„λ°© μ„Όμ„: μµμ†κ±°λ¦¬ 2.500m, μ¥μ• λ¬Ό 0κ°
   μ „μ²΄ μµμ†κ±°λ¦¬: 1.200m, μ΄ μ¥μ• λ¬Ό: 2κ°
```

## π”§ κ°λ°

### μƒλ΅μ΄ μ μ–΄ λ΅μ§ μ¶”κ°€

1. `scripts/` λ””λ ‰ν† λ¦¬μ— μƒ μ μ–΄ μ¤ν¬λ¦½νΈ μƒμ„±
2. `CMakeLists.txt`μ— μ‹¤ν–‰ νμΌ λ“±λ΅
3. ν•„μ”μ‹ λ°μΉ νμΌμ— λ…Έλ“ μ¶”κ°€

### μƒλ΅μ΄ μ„¤μ • νμΌ μ¶”κ°€

1. `config/` λ””λ ‰ν† λ¦¬μ— μƒ μ„¤μ • νμΌ μƒμ„±
2. λ°μΉ νμΌμ—μ„ νλΌλ―Έν„° λ΅λ“ ν™•μΈ
3. μ½”λ“μ—μ„ νλΌλ―Έν„° μ½κΈ° κµ¬ν„

## π¨ μ•μ „ μ£Όμμ‚¬ν•­

### μ²« μ‹¤ν–‰ μ‹
1. **μ¶©λ¶„ν• κ³µκ°„ ν™•λ³΄**: λ΅λ΄‡ μ£Όλ³€μ— μ¥μ• λ¬Όμ΄ μ—†λ”μ§€ ν™•μΈ
2. **λ‚®μ€ μ†λ„λ΅ ν…μ¤νΈ**: `normal_speed:=0.1`λ΅ μ„¤μ •
3. **λΉ„μƒμ •μ§€ μ¤€λΉ„**: μ–Έμ λ“ μ§€ μ‹μ¤ν…μ„ μ¤‘λ‹¨ν•  μ μλ„λ΅ μ¤€λΉ„

### μΌλ° μ‚¬μ© μ‹
1. **μ„Όμ„ μƒνƒ ν™•μΈ**: λΌμ΄λ‹¤ μ„Όμ„κ°€ μ •μƒ μ‘λ™ν•λ”μ§€ ν™•μΈ
2. **μ•μ „ κ±°λ¦¬ μ„¤μ •**: ν™κ²½μ— λ§κ² μ•μ „ κ±°λ¦¬ μ΅°μ •
3. **μ •κΈ°μ  μ κ²€**: μ„Όμ„ λ°μ΄ν„°κ°€ μ •μƒμ μΌλ΅ μμ‹ λλ”μ§€ ν™•μΈ

## π› νΈλ¬λΈ”μν…

### μ„Όμ„ λ°μ΄ν„° μμ‹  μ•λ¨

1. λ΅λ΄‡ μ—°κ²° μƒνƒ ν™•μΈ
2. λΌμ΄λ‹¤ μ„Όμ„ ν•λ“μ›¨μ–΄ μƒνƒ ν™•μΈ
3. ν† ν”½ κµ¬λ… μƒνƒ ν™•μΈ

### μ¥μ• λ¬Ό κ°μ§€κ°€ λ¶€μ •ν™•ν•¨

1. μ„Όμ„ νλΌλ―Έν„° μ΅°μ •
2. λ…Έμ΄μ¦ ν•„ν„°λ§ μ„¤μ • ν™•μΈ
3. μ•μ „ κ±°λ¦¬ μ„κ³„κ°’ μ΅°μ •

### λ΅λ΄‡μ΄ μ›€μ§μ΄μ§€ μ•μ

1. λ΅λ΄‡ μ—°κ²° μƒνƒ ν™•μΈ
2. λΉ„μƒμ •μ§€ μƒνƒ ν™•μΈ
3. μ†λ„ λ…λ Ήμ΄ μ •μƒμ μΌλ΅ μ „μ†΅λλ”μ§€ ν™•μΈ

## π“ μ§€μ›

λ¬Έμ κ°€ λ°μƒν•λ©΄ λ‹¤μμ„ ν™•μΈν•μ„Έμ”:

1. λ΅κ·Έ λ©”μ‹μ§€ ν™•μΈ
2. ROS ν† ν”½ μƒνƒ ν™•μΈ
3. μ„Όμ„ λ°μ΄ν„° μμ‹  μƒνƒ ν™•μΈ
4. λ΅λ΄‡ μ—°κ²° μƒνƒ ν™•μΈ

## π“„ λΌμ΄μ„ μ¤

MIT License

## π‘¥ κΈ°μ—¬μ

- User (KATECH μ—°κµ¬μ›) - ν”„λ΅μ νΈ μ„¤κ³„ λ° κµ¬ν„

---

**λ²„μ „**: v1.0.0  
**μµμΆ… μ—…λ°μ΄νΈ**: 2025λ…„ 10μ›” 01μΌ
