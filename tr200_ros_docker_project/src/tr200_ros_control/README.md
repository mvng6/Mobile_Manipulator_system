# TR200 ROS Control Package

TR200 λ΅λ΄‡μ„ ROS Noetic ν™κ²½μ—μ„ SDKμ™€ μ—°λ™ν•μ—¬ ν‚¤λ³΄λ“ μ…λ ¥μ„ ν†µν• μ›κ²© μ μ–΄λ¥Ό μ κ³µν•λ” ν¨ν‚¤μ§€μ…λ‹λ‹¤.

## π“‹ κ°μ”

μ΄ ν¨ν‚¤μ§€λ” TR200 λ΅λ΄‡μ„ ROS ν™κ²½μ—μ„ μ μ–΄ν•κΈ° μ„ν• ν†µν•© μ†”λ£¨μ…μ„ μ κ³µν•©λ‹λ‹¤. SDKλ¥Ό ν†µν• λ΅λ΄‡ μ—°κ²°, ν‚¤λ³΄λ“ μ…λ ¥ μ²λ¦¬, μ•μ „ μ μ–΄, μ›κ²© μ μ–΄ λ“±μ κΈ°λ¥μ„ ν¬ν•¨ν•©λ‹λ‹¤.

## π—οΈ μ‹μ¤ν… κµ¬μ΅°

### λ…Έλ“ κµ¬μ„±
- **Robot Connection Node**: TR200 λ΅λ΄‡κ³Όμ SDK μ—°κ²° κ΄€λ¦¬
- **Remote Control Node**: ν‚¤λ³΄λ“ μ…λ ¥μ„ ν†µν• μ›κ²© μ μ–΄
- **Robot Driver Node**: λ΅λ΄‡ κµ¬λ™ μ μ–΄ λ° λ…λ Ή μ‹¤ν–‰

### ROS ν† ν”½
- `/cmd_vel`: λ΅λ΄‡ μ†λ„ λ…λ Ή
- `/remote_cmd_vel`: μ›κ²© μ μ–΄ λ…λ Ή
- `/connection_status`: λ΅λ΄‡ μ—°κ²° μƒνƒ
- `/robot_status`: λ΅λ΄‡ μƒνƒ μ •λ³΄

### ROS μ„λΉ„μ¤
- `/set_safety_params`: μ•μ „ νλΌλ―Έν„° μ„¤μ •
- `/get_robot_status`: λ΅λ΄‡ μƒνƒ μ΅°ν

## π€ λΉ λ¥Έ μ‹μ‘

### 1. ν™κ²½ μ„¤μ •

Docker μ»¨ν…μ΄λ„μ—μ„ μ‘μ—…:
```bash
# μ»¨ν…μ΄λ„ μ‹¤ν–‰
./scripts/run_container.sh

# ROS λ§μ¤ν„° μ‹¤ν–‰
roscore

# μ¶”κ°€ ν„°λ―Έλ„ μ ‘μ†
./scripts/connect_container.sh
```

### 2. ν¨ν‚¤μ§€ λΉλ“

```bash
cd /catkin_ws
catkin_make
source devel/setup.bash
```

### 3. μ›κ²© μ μ–΄ μ‹¤ν–‰

#### λ°©λ²• 1: λ¶„λ¦¬λ μ‹¤ν–‰ (κ¶μ¥)
```bash
# ν„°λ―Έλ„ 1μ—μ„ κΈ°λ³Έ μ‹μ¤ν… μ‹¤ν–‰
roslaunch tr200_ros_control tr200_base_system.launch

# ν„°λ―Έλ„ 2μ—μ„ ν‚¤λ³΄λ“ μ μ–΄ μ‹¤ν–‰
roslaunch tr200_ros_control tr200_keyboard_control.launch
```

#### λ°©λ²• 2: ν†µν•© μ‹¤ν–‰ (κ°„λ‹¨ν• ν…μ¤νΈμ©)
```bash
# λ¨λ“  λ…Έλ“λ¥Ό ν• λ²μ— μ‹¤ν–‰
roslaunch tr200_ros_control tr200_remote_control.launch
```

#### λ°©λ²• 3: μ•μ „ λ¨λ“ μ‹¤ν–‰ (κ°λ°μ©)
```bash
# λ§¤μ° λ‚®μ€ μ†λ„λ΅ μ‹¤ν–‰
roslaunch tr200_ros_control tr200_keyboard_control_safe.launch
```

### 4. ν‚¤λ³΄λ“ μ μ–΄

ν„°λ―Έλ„μ„ ν΄λ¦­ν• ν›„ λ‹¤μ ν‚¤λ¥Ό μ‚¬μ©ν•μ—¬ λ΅λ΄‡μ„ μ μ–΄ν•  μ μμµλ‹λ‹¤:

#### κΈ°λ³Έ μ΄λ™ μ μ–΄
- **`w`** - μ „μ§„ (μ•μΌλ΅ μ΄λ™)
- **`s`** - ν›„μ§„ (λ’¤λ΅ μ΄λ™)
- **`a`** - μΆνμ „ (μ™Όμ½μΌλ΅ νμ „ν•λ©° μ΄λ™)
- **`d`** - μ°νμ „ (μ¤λ¥Έμ½μΌλ΅ νμ „ν•λ©° μ΄λ™)

#### μ μλ¦¬ νμ „
- **`q`** - μ μλ¦¬ μΆνμ „ (ν„μ¬ μ„μΉμ—μ„ μ™Όμ½μΌλ΅ νμ „)
- **`e`** - μ μλ¦¬ μ°νμ „ (ν„μ¬ μ„μΉμ—μ„ μ¤λ¥Έμ½μΌλ΅ νμ „)

#### μ μ–΄ λ…λ Ή
- **`μ¤νμ΄μ¤`** - μ •μ§€ (μ¦‰μ‹ μ •μ§€)
- **`x`** - λΉ„μƒμ •μ§€ (κΈ΄κΈ‰ μ •μ§€)

#### μ‹μ¤ν… λ…λ Ή
- **`h`** - λ„μ›€λ§ ν‘μ‹
- **`c`** - μ—°κ²° μƒνƒ ν™•μΈ
- **`r`** - μ‹μ¤ν… λ¦¬μ…‹

#### μΆ…λ£
- **`Ctrl+C`** - μ‹μ¤ν… μΆ…λ£

## π“ ν¨ν‚¤μ§€ κµ¬μ΅°

```
tr200_ros_control/
β”β”€β”€ CMakeLists.txt                    # λΉλ“ μ„¤μ •
β”β”€β”€ package.xml                      # ν¨ν‚¤μ§€ λ§¤λ‹νμ¤νΈ
β”β”€β”€ README.md                        # ν¨ν‚¤μ§€ λ¬Έμ„
β”β”€β”€ launch/                          # ROS λ°μΉ νμΌ
β”‚   β”β”€β”€ tr200_remote_control.launch      # ν†µν•© μ›κ²© μ μ–΄ λ°μΉ
β”‚   β”β”€β”€ tr200_base_system.launch         # κΈ°λ³Έ μ‹μ¤ν… λ°μΉ
β”‚   β”β”€β”€ tr200_keyboard_control.launch    # ν‚¤λ³΄λ“ μ μ–΄ λ°μΉ
β”‚   β””β”€β”€ tr200_keyboard_control_safe.launch # μ•μ „ λ¨λ“ λ°μΉ
β”β”€β”€ config/                          # μ„¤μ • νμΌ
β”‚   β”β”€β”€ robot_params.yaml               # λ΅λ΄‡ κΈ°λ³Έ νλΌλ―Έν„°
β”‚   β”β”€β”€ safety_params.yaml             # μ•μ „ μ μ–΄ νλΌλ―Έν„°
β”‚   β””β”€β”€ sensor_params.yaml             # μ„Όμ„ νλΌλ―Έν„°
β”β”€β”€ scripts/                         # Python μ μ–΄ μ¤ν¬λ¦½νΈ
β”‚   β”β”€β”€ robot_connection_node.py        # λ΅λ΄‡ μ—°κ²° κ΄€λ¦¬ λ…Έλ“
β”‚   β”β”€β”€ remote_control_node.py         # μ›κ²© μ μ–΄ λ…Έλ“
β”‚   β””β”€β”€ robot_driver_node.py           # λ΅λ΄‡ κµ¬λ™ μ μ–΄ λ…Έλ“
β”β”€β”€ srv/                             # ROS μ„λΉ„μ¤ μ •μ
β”‚   β”β”€β”€ SetSafetyParams.srv             # μ•μ „ νλΌλ―Έν„° μ„¤μ • μ„λΉ„μ¤
β”‚   β””β”€β”€ GetRobotStatus.srv              # λ΅λ΄‡ μƒνƒ μ΅°ν μ„λΉ„μ¤
β””β”€β”€ msg/                             # ROS λ©”μ‹μ§€ μ •μ
    β”β”€β”€ SafetyStatus.msg                # μ•μ „ μƒνƒ λ©”μ‹μ§€
    β””β”€β”€ RobotStatus.msg                 # λ΅λ΄‡ μƒνƒ λ©”μ‹μ§€
```

## β™οΈ μ„¤μ •

### λ΅λ΄‡ μ—°κ²° μ„¤μ •

`config/robot_params.yaml`μ—μ„ λ΅λ΄‡ μ—°κ²° μ •λ³΄λ¥Ό μ„¤μ •ν•  μ μμµλ‹λ‹¤:

```yaml
robot:
  ip: "169.254.128.2"  # TR200 λ΅λ΄‡ IP
  port: 5480           # TR200 λ΅λ΄‡ ν¬νΈ
  identity: "tr200_ros_controller"
```

### μ›κ²© μ μ–΄ μ„¤μ •

λ°μΉ νμΌμ—μ„ μ›κ²© μ μ–΄ νλΌλ―Έν„°λ¥Ό μ΅°μ •ν•  μ μμµλ‹λ‹¤:

```bash
roslaunch tr200_ros_control tr200_remote_control.launch \
  linear_speed:=0.3 \
  angular_speed:=0.3 \
  command_timeout:=3.0
```

### μ•μ „ μ„¤μ •

`config/safety_params.yaml`μ—μ„ μ•μ „ μ μ–΄ νλΌλ―Έν„°λ¥Ό μ„¤μ •ν•  μ μμµλ‹λ‹¤:

```yaml
sensor:
  min_obstacle_distance: 0.5    # μµμ† μ¥μ• λ¬Ό κ±°λ¦¬
  warning_distance: 0.8         # κ²½κ³  κ±°λ¦¬
  safe_distance: 1.0           # μ•μ „ κ±°λ¦¬

control:
  normal_speed: 0.2            # μ •μƒ μ†λ„
  slow_speed: 0.1              # κ°μ† μ†λ„
  stop_speed: 0.0              # μ •μ§€ μ†λ„
```

## π”§ κ°λ°

### μƒλ΅μ΄ λ…Έλ“ μ¶”κ°€

1. `scripts/` λ””λ ‰ν† λ¦¬μ— μƒ λ…Έλ“ νμΌ μƒμ„±
2. `CMakeLists.txt`μ— μ¤ν¬λ¦½νΈ μ„¤μΉ μ¶”κ°€
3. ν•„μ”μ‹ λ°μΉ νμΌμ— λ…Έλ“ μ¶”κ°€

### λ©”μ‹μ§€/μ„λΉ„μ¤ μ¶”κ°€

1. `msg/` λλ” `srv/` λ””λ ‰ν† λ¦¬μ— μƒ νμΌ μƒμ„±
2. `CMakeLists.txt`μ— λ©”μ‹μ§€/μ„λΉ„μ¤ μ¶”κ°€
3. `package.xml`μ— μμ΅΄μ„± μ¶”κ°€
4. `catkin_make` μ‹¤ν–‰

## π“ λ¨λ‹ν„°λ§

### ν† ν”½ λ¨λ‹ν„°λ§

```bash
# μ—°κ²° μƒνƒ ν™•μΈ
rostopic echo /connection_status

# μ›κ²© μ μ–΄ λ…λ Ή ν™•μΈ
rostopic echo /remote_cmd_vel

# λ΅λ΄‡ μƒνƒ ν™•μΈ
rostopic echo /robot_status
```

### λ…Έλ“ μƒνƒ ν™•μΈ

```bash
# μ‹¤ν–‰ μ¤‘μΈ λ…Έλ“ ν™•μΈ
rosnode list

# λ…Έλ“ μ •λ³΄ ν™•μΈ
rosnode info /robot_connection_node
rosnode info /remote_control_node
rosnode info /robot_driver_node
```

### μ„λΉ„μ¤ μ‚¬μ©

```bash
# μ•μ „ νλΌλ―Έν„° λ™μ  λ³€κ²½
rosservice call /set_safety_params "min_obstacle_distance: 0.3
warning_distance: 0.6
safe_distance: 0.9
normal_speed: 0.15
slow_speed: 0.05"

# λ΅λ΄‡ μƒνƒ μ΅°ν
rosservice call /get_robot_status "request: true"
```

## π¨ μ•μ „ μ£Όμμ‚¬ν•­

### μ²« μ‹¤ν–‰ μ‹
1. **λ‚®μ€ μ†λ„λ΅ ν…μ¤νΈ**: `linear_speed:=0.1, angular_speed:=0.1`
2. **μ¶©λ¶„ν• κ³µκ°„ ν™•λ³΄**: λ΅λ΄‡ μ£Όλ³€μ— μ¥μ• λ¬Όμ΄ μ—†λ”μ§€ ν™•μΈ
3. **λΉ„μƒμ •μ§€ μ¤€λΉ„**: μ–Έμ λ“ μ§€ `x` ν‚¤λ¥Ό λ„λ¥Ό μ μλ„λ΅ μ¤€λΉ„

### μΌλ° μ‚¬μ© μ‹
1. **λ΅λ΄‡ μ—°κ²° μƒνƒ ν™•μΈ**: `c` ν‚¤λ΅ μ—°κ²° μƒνƒ ν™•μΈ
2. **λ¶€λ“λ¬μ΄ μ΅°μ‘**: κΈ‰κ²©ν• λ°©ν–¥ μ „ν™ ν”Όν•κΈ°
3. **μ •κΈ°μ  μ •μ§€**: `μ¤νμ΄μ¤` ν‚¤λ΅ μ£ΌκΈ°μ  μ •μ§€

## π› νΈλ¬λΈ”μν…

### λ΅λ΄‡ μ—°κ²° μ‹¤ν¨

1. λ΅λ΄‡ IP μ£Όμ† ν™•μΈ
2. λ„¤νΈμ›ν¬ μ—°κ²° μƒνƒ ν™•μΈ
3. λ΅λ΄‡ μ „μ› μƒνƒ ν™•μΈ
4. λ°©ν™”λ²½ μ„¤μ • ν™•μΈ

### ν‚¤λ³΄λ“ μ…λ ¥μ΄ μ‘λ™ν•μ§€ μ•μ

1. ν„°λ―Έλ„μ„ ν΄λ¦­ν•μ—¬ ν¬μ»¤μ¤ ν™•μΈ
2. ν‚¤λ³΄λ“ κ¶ν• ν™•μΈ
3. λ…Έλ“ μ‹¤ν–‰ μƒνƒ ν™•μΈ

### μ„Όμ„ λ°μ΄ν„° μμ‹  μ•λ¨

1. λ΅λ΄‡ μ—°κ²° μƒνƒ ν™•μΈ
2. μ„Όμ„ ν•λ“μ›¨μ–΄ μƒνƒ ν™•μΈ
3. ν† ν”½ κµ¬λ… μƒνƒ ν™•μΈ

## π“ μ§€μ›

λ¬Έμ κ°€ λ°μƒν•λ©΄ λ‹¤μμ„ ν™•μΈν•μ„Έμ”:

1. λ΅κ·Έ λ©”μ‹μ§€ ν™•μΈ
2. ROS ν† ν”½ μƒνƒ ν™•μΈ
3. λ…Έλ“ μ‹¤ν–‰ μƒνƒ ν™•μΈ
4. λ„¤νΈμ›ν¬ μ—°κ²° μƒνƒ ν™•μΈ

## π“„ λΌμ΄μ„ μ¤

MIT License

## π‘¥ κΈ°μ—¬μ

- User (KATECH μ—°κµ¬μ›) - ν”„λ΅μ νΈ μ„¤κ³„ λ° κµ¬ν„

---

**λ²„μ „**: v1.0.0  
**μµμΆ… μ—…λ°μ΄νΈ**: 2025λ…„ 10μ›” 01μΌ